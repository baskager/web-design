!function(){var o=document.querySelector("#contactForm"),a=(document.querySelector("#load"),document.querySelector("#success"),document.querySelector("#error"),o.querySelectorAll("[v-map='true']")),n=o.querySelector("button"),t=o.querySelectorAll(".close"),s={linkedInUrl:"http://linkedin.com/in/sebastiaan-kager",contactEndpoint:"/contact",retryCountdowntime:10,retryAmount:2,retries:0};n.disabled=!0;for(var i=function(e){var t=document.querySelector("#"+e);t.style.zIndex=99,t.style.opacity=1},u=function(e){var t=document.querySelector("#"+e);t.style.zIndex=-1,t.style.opacity=0},r=function(){for(var e=o.querySelectorAll(".loading-info"),t=0;t<e.length;t++){var r=e[t];r.style.zIndex=-1,r.style.opacity=0}},l=function(e,t){document.querySelector("#"+e).querySelector("#message").innerHTML=t},c=function(e,t){document.querySelector("#"+e).querySelector("#message").innerHTML+=t},e=0;e<=a.length-1;e++)a[e].addEventListener("input",function(e){validateAll()});n.addEventListener("click",function(e){e.preventDefault();var t=a[0].value,r=a[1].value,n=a[2].value;submit(t,r,n,!1)}),submit=function(r,n,a,l){setDisabledAll(),o.style.zIndex=0;var e=new XMLHttpRequest;u("error"),i("load"),e.open("POST",s.contactEndpoint,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.setRequestHeader("xhr","true"),e.onreadystatechange=function(){if(s.lastStatus=this.status,this.readyState==XMLHttpRequest.DONE)if(s.lastStatus?s.lastResponse=JSON.parse(this.responseText):s.lastResponse=null,s.retries++,_renderStatus(s.lastStatus,s.lastResponse,s.retries),200===s.lastStatus)l=!0;else{var e=s.retryCountdowntime;if(s.retries<=s.retryAmount)var t=setInterval(function(){e--,_renderStatus(s.lastStatus,s.lastResponse,s.retries,e),1===e&&(u("error"),i("load")),e<=0&&(clearInterval(t),submit(r,n,a,l))},1e3)}},e.send("name="+r+"&message="+n+"&email="+a)},_renderStatus=function(e,t,r,n){return 200===e?(u("load"),u("error"),i("success")):(u("load"),t&&t.error&&"validation_map_init"===t.error.type&&l("error","The server could not process your data."),t&&t.error&&"mailer"===t.error.type&&l("error","An error occured while sending the email."),null===t&&l("error","Could not connect to the server"),400===e&&(l("error","The server could not verify your inputs"),s.retries=s.retryAmount+1,r=s.retryAmount+1),r<=s.retryAmount?c("error","<br> Retrying again in "+n+" seconds. <br><br><b>Attempt "+r+"</b>"):(enableCloseScreenButton(),c("error","<br><br> Please feel free to contact me on my <a target='_blank' href='"+s.linkedInUrl+"'>LinkedIn</a> instead, I am very sorry for the inconvenience.<br><br> <i>The occurance has been logged and I will review the issue.</i>")),i("error")),!1},_checkMinValue=function(e){return e.value.length>=e.minLength},_checkMaxValue=function(e){return e.value.length<=e.maxLength},_checkEmail=function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e.value).toLowerCase())},setDisabledAll=function(e){null==e&&(e=!0);for(var t=0;t<=a.length-1;t++){a[t].disabled=e}n.disabled=e},enableCloseScreenButton=function(){for(var e=0;e<t.length;e++)t[e].addEventListener("click",function(e){e.preventDefault(),setDisabledAll(!1),r(),s.retries=0,disableCloseScreenButton()}),t[e].style.display="block"},disableCloseScreenButton=function(){for(var e=0;e<t.length;e++)t[e].style.display="none"},clearInputs=function(){for(var e=0;e<=a.length-1;e++){a[e].value=""}validateAll()},validateInput=function(e){var t=!0;return _checkMinValue(e)||(t=!1),_checkMaxValue(e)||(t=!1),"email"===e.type&&(_checkEmail(e)||(t=!1)),t},validateAll=function(){for(var e=0;e<=a.length-1;e++){var t=a[e],r=validateInput(t);r||0===t.value.length?t.classList.remove("invalid"):t.classList.add("invalid"),r?t.classList.add("valid"):t.classList.remove("valid"),"name"===t.name&&r&&(a[1].placeholder=t.value+" is a lovely name, please write your message here"),"name"!==t.name||r||(a[1].placeholder="Message"),"message"===t.name&&r&&(a[2].placeholder="Great stuff! Just need your e-mail address now"),"message"!==t.name||r||(a[2].placeholder="Email address"),a[e].valid=r}return a[0].valid&&a[1].valid&&a[2].valid?n.disabled=!1:n.disabled=!0,r},validateAll()}();